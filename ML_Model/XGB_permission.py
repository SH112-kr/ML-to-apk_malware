# -*- coding: utf-8 -*-
"""TestXGB.ipynb
Automatically generated by Colaboratory.
Original file is located at
    https://colab.research.google.com/drive/18AHC-DK2g0MqGuoaoksDFl-DRrE7f-Eb
"""

import pandas as pd
import numpy as np
import xgboost as xgb

totaldata=pd.read_csv('')
totaldata.head()

features=totaldata.iloc[:,:-2]
labels=totaldata.Type
features.head()

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test =train_test_split(features, labels, test_size=0.3, random_state=100)

from xgboost import XGBClassifier
from sklearn.metrics import confusion_matrix
from sklearn.metrics import accuracy_score, recall_score, roc_auc_score,precision_score


sklearn_xgboost_model = XGBClassifier(n_estimators=400, learning_rate=0.1, max_depth=3)
sklearn_xgboost_model.fit(X_train,y_train)

y_pred = sklearn_xgboost_model.predict(X_test)

def classifier_eval(y_test, y_pred):
  print('오차: ', confusion_matrix(y_test, y_pred))
  print('정확도: ', accuracy_score(y_test, y_pred))
  print('정밀도: ', precision_score(y_test, y_pred))
  print('재현율: ', recall_score(y_test, y_pred))
  print('AUC: ', roc_auc_score(y_test, y_pred))

classifier_eval(y_test, y_pred)

from xgboost import plot_importance
import matplotlib.pyplot as plt

fig,ax = plt.subplots(figsize=(12,14))
plot_importance(sklearn_xgboost_model,ax=ax)
